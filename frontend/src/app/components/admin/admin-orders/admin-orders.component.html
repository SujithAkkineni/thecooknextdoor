<div class="orders-container">
  <!-- Header -->
  <header class="page-header">
    <div class="header-left">
      <h1>Order Management</h1>
      <p>Welcome back, {{ currentAdmin?.username }}</p>
    </div>
    <button class="logout-btn" (click)="logout()">Logout</button>
  </header>

  <!-- Navigation -->
  <nav class="page-nav">
    <button class="nav-btn" (click)="navigateTo('dashboard')">Dashboard</button>
    <button class="nav-btn active">Orders</button>
    <button class="nav-btn" (click)="navigateTo('products')">Products</button>
    <button class="nav-btn" (click)="navigateTo('customers')">Customers</button>
  </nav>

  <!-- Filters and Search -->
  <div class="filters-section">
    <div class="filter-controls">
      <div class="search-bar">
        <input
          type="text"
          placeholder="Search by customer or food..."
          [(ngModel)]="searchTerm"
          (input)="onSearchChange(searchTerm)"
          class="search-input">
        <i class="fas fa-search search-icon"></i>
      </div>

      <div class="status-filters">
        <button
          class="filter-btn"
          [class.active]="statusFilter === 'all'"
          (click)="onStatusFilterChange('all')">All Orders</button>
        <button
          class="filter-btn"
          [class.active]="statusFilter === 'pending'"
          (click)="onStatusFilterChange('pending')">Pending</button>
        <button
          class="filter-btn"
          [class.active]="statusFilter === 'completed'"
          (click)="onStatusFilterChange('completed')">Completed</button>
      </div>
    </div>

    <div class="results-summary">
      Showing {{ filteredOrders.length }} of {{ orders.length }} orders
    </div>
  </div>

  <!-- Orders Table -->
  <div class="orders-table-container" *ngIf="!loading">
    <table class="orders-table" *ngIf="filteredOrders.length > 0; else noOrders">
      <thead>
        <tr>
          <th>Order ID</th>
          <th>Customer</th>
          <th>Food Item</th>
          <th>Price</th>
          <th>Delivery</th>
          <th>Status</th>
          <th>Date & Time</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let order of filteredOrders">
          <td>#{{ order._id.slice(-6) }}</td>
          <td>
            <div class="customer-info">
              <strong>{{ order.buyerName }}</strong>
              <br>
              <small>{{ order.address }}</small>
            </div>
          </td>
          <td>{{ order.foodId.name }}</td>
          <td class="price-cell">â‚¹{{ order.foodId.price }}</td>
          <td>
            <span class="delivery-badge" [class]="order.deliveryOption">
              {{ order.deliveryOption === 'walk' ? 'Walk-in' : 'Home Delivery' }}
            </span>
          </td>
          <td>
            <span class="status-badge" [class]="getStatusClass(order.paymentStatus)">
              {{ order.paymentStatus | titlecase }}
            </span>
          </td>
          <td>{{ formatDate(order.createdAt) }}</td>
          <td>
            <div class="actions-cell" *ngIf="order.paymentStatus === 'pending'">
              <button
                class="action-btn complete-btn"
                (click)="updateOrderStatus(order._id, 'completed')">
                Mark Complete
              </button>
            </div>
            <span class="no-action" *ngIf="order.paymentStatus !== 'pending'">
              No action needed
            </span>
          </td>
        </tr>
      </tbody>
    </table>

    <ng-template #noOrders>
      <div class="no-orders">
        <i class="fas fa-shopping-cart empty-icon"></i>
        <h3>No orders found</h3>
        <p>Try adjusting your filters or check back later.</p>
      </div>
    </ng-template>
  </div>

  <!-- Loading State -->
  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading orders...</p>
  </div>
</div>
